"use strict";(self.webpackChunktc_book_store_ui=self.webpackChunktc_book_store_ui||[]).push([[366],{8366:(P,_,s)=>{s.r(_),s.d(_,{UsersModule:()=>Y});var u=s(4828),o=s(6223),p=s(8101),t=s(5879),T=s(8040),v=s(4974),y=s(2939),w=s(6814),l=s(5195),m=s(9157),b=s(2032),h=s(617),g=s(2296);function C(e,a){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid email format"),t.qZA())}let U=(()=>{class e{constructor(n,r,i,d,c){this.authService=n,this.tokenStorage=r,this._snackBar=i,this.router=d,this.route=c,this.hide=!0,this.errorMessage="",this.roles=[],this.myError=(Z,f)=>this.myForm.controls[Z].hasError(f)}ngOnInit(){this.myForm=new o.cw({email:new o.NI("",[o.kI.required,o.kI.email]),password:new o.NI("",[o.kI.required])}),this.tokenStorage.getToken()&&this.router.navigate(["/"])}onSubmit(){const{email:n,password:r}=this.myForm.value;this.authService.login(n,r).subscribe({next:i=>{this.tokenStorage.saveToken(i.token),this.tokenStorage.saveUser(i),p.A.showMessage(this._snackBar,"Logged in successfully!");const d=this.route.snapshot.queryParams.returnUrl||"/";setTimeout(()=>{this.router.navigateByUrl(d)},1e3)},error:i=>{this.errorMessage=i.error.message?i.error.message:"Login failed!",p.A.showMessage(this._snackBar,this.errorMessage)}})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(T.e),t.Y36(v.i),t.Y36(y.ux),t.Y36(u.F0),t.Y36(u.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["login"]],decls:23,vars:7,consts:[[1,"login-form","mx-auto","my-5"],[1,"py-3"],[1,"text-center","mt-3","mb-4","fs-2"],[3,"formGroup","ngSubmit"],[1,"w-100"],["matInput","","type","email","formControlName","email","id","email"],[4,"ngIf"],[1,"w-100","mb-4"],["matInput","","formControlName","password","id","password",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],[1,"text-end"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["routerLink","../register",1,"btn","btn-link"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"mat-card",1)(2,"mat-card-title",2),t._uU(3,"Login"),t.qZA(),t.TgZ(4,"mat-card-content")(5,"form",3),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(6,"mat-form-field",4)(7,"mat-label"),t._uU(8,"Email"),t.qZA(),t._UZ(9,"input",5),t.YNc(10,C,2,0,"mat-error",6),t.qZA(),t.TgZ(11,"mat-form-field",7)(12,"mat-label"),t._uU(13,"Password"),t.qZA(),t._UZ(14,"input",8),t.TgZ(15,"button",9),t.NdJ("click",function(){return r.hide=!r.hide}),t.TgZ(16,"mat-icon"),t._uU(17),t.qZA()()(),t.TgZ(18,"div",10)(19,"button",11),t._uU(20,"Login"),t.qZA(),t.TgZ(21,"a",12),t._uU(22,"Register"),t.qZA()()()()()()),2&n&&(t.xp6(5),t.Q6J("formGroup",r.myForm),t.xp6(5),t.Q6J("ngIf",r.myError("email","email")),t.xp6(4),t.Q6J("type",r.hide?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",r.hide),t.xp6(2),t.Oqu(r.hide?"visibility_off":"visibility"),t.xp6(2),t.Q6J("disabled",!r.myForm.valid))},dependencies:[u.rH,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,w.O5,l.a8,l.dn,l.n5,m.KE,m.hX,m.TO,m.R9,b.Nt,h.Hw,g.lW,g.RK],styles:[".login-form[_ngcontent-%COMP%]{max-width:500px}"]}),e})();var I=s(553);function N(e,a){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Not more then 30 characters long."),t.qZA())}function A(e,a){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Not more then 30 characters long."),t.qZA())}function k(e,a){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid email"),t.qZA())}function x(e,a){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Not more then 3 characters long."),t.qZA())}function q(e,a){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid password: must have lower-case, upper-case, numbers, symbols and at least 6 characters long"),t.qZA())}function L(e,a){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Passwords do not match"),t.qZA())}let J=(()=>{class e{constructor(n,r,i){this.authService=n,this._snackBar=r,this.router=i,this.hide=!0,this.hide2=!0,this.errorMessage="",this.myError=(d,c)=>this.myForm.controls[d].hasError(c)}ngOnInit(){this.myForm=new o.cw({firstName:new o.NI("",[o.kI.required,o.kI.maxLength(30)]),lastName:new o.NI("",[o.kI.required,o.kI.maxLength(30)]),email:new o.NI("",[o.kI.required,o.kI.email]),password:new o.NI("",[o.kI.required,o.kI.pattern("^(?=.*[A-Z])(?=.*[0-9])(?=.*[a-z])(?=.*[!@#$%^&*]).{5,}$")]),confirmPassword:new o.NI("",[o.kI.required]),adminCode:new o.NI("",[o.kI.maxLength(6)])},{validators:M})}onSubmit(){const{firstName:n,lastName:r,email:i,password:d,adminCode:c}=this.myForm.value;let Z=!1;c&&c===I.N.adminCode&&(Z=!0),this.authService.register(n,r,i,d,Z).subscribe({next:f=>{p.A.showMessage(this._snackBar,"Registration success!"),setTimeout(()=>{this.router.navigate(["/users/login"])},1e3)},error:f=>{this.errorMessage=f.error.message?f.error.message:"Registration failed!",p.A.showMessage(this._snackBar,this.errorMessage)}})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(T.e),t.Y36(y.ux),t.Y36(u.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["register"]],decls:51,vars:16,consts:[[1,"register-form","mx-auto","my-5"],[1,"py-3"],[1,"text-center","mt-3","mb-4","fs-2"],[3,"formGroup","ngSubmit"],[1,"w-50","pe-2"],["matInput","","type","text","formControlName","firstName","id","firstName"],[4,"ngIf"],[1,"w-50"],["matInput","","type","text","formControlName","lastName","id","lastName"],[1,"w-100"],["matInput","","type","email","formControlName","email","id","email"],["matInput","","type","text","formControlName","adminCode","id","adminCode"],["align","end"],[1,"w-100","mb-4"],["matInput","","formControlName","password","id","password",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["matInput","","formControlName","confirmPassword","id","confirmPassword",3,"type"],[1,"text-end"],["mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"],["routerLink","../login",1,"btn","btn-link"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"mat-card",1)(2,"mat-card-title",2),t._uU(3,"Register"),t.qZA(),t.TgZ(4,"mat-card-content")(5,"form",3),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(6,"mat-form-field",4)(7,"mat-label"),t._uU(8,"First Name"),t.qZA(),t._UZ(9,"input",5),t.YNc(10,N,2,0,"mat-error",6),t.qZA(),t.TgZ(11,"mat-form-field",7)(12,"mat-label"),t._uU(13,"Last Name"),t.qZA(),t._UZ(14,"input",8),t.YNc(15,A,2,0,"mat-error",6),t.qZA(),t.TgZ(16,"mat-form-field",9)(17,"mat-label"),t._uU(18,"Email"),t.qZA(),t._UZ(19,"input",10),t.YNc(20,k,2,0,"mat-error",6),t.qZA(),t.TgZ(21,"mat-form-field",9)(22,"mat-label"),t._uU(23,"Admin Code"),t.qZA(),t._UZ(24,"input",11),t.TgZ(25,"mat-hint",12),t._uU(26,"This field is for testing admin role. Code is 111"),t.qZA(),t.YNc(27,x,2,0,"mat-error",6),t.qZA(),t.TgZ(28,"mat-form-field",13)(29,"mat-label"),t._uU(30,"Password"),t.qZA(),t._UZ(31,"input",14),t.TgZ(32,"button",15),t.NdJ("click",function(){return r.hide=!r.hide}),t.TgZ(33,"mat-icon"),t._uU(34),t.qZA()(),t.TgZ(35,"mat-hint",12),t._uU(36,"Password must have lower-case, upper-case, numbers, symbols and at least 6 characters long."),t.qZA(),t.YNc(37,q,2,0,"mat-error",6),t.qZA(),t.TgZ(38,"mat-form-field",13)(39,"mat-label"),t._uU(40,"Confirm Password"),t.qZA(),t._UZ(41,"input",16),t.TgZ(42,"button",15),t.NdJ("click",function(){return r.hide2=!r.hide2}),t.TgZ(43,"mat-icon"),t._uU(44),t.qZA()(),t.YNc(45,L,2,0,"mat-error",6),t.qZA(),t.TgZ(46,"div",17)(47,"button",18),t._uU(48,"Register"),t.qZA(),t.TgZ(49,"a",19),t._uU(50,"Cancel"),t.qZA()()()()()()),2&n&&(t.xp6(5),t.Q6J("formGroup",r.myForm),t.xp6(5),t.Q6J("ngIf",r.myError("firstName","maxlength")),t.xp6(5),t.Q6J("ngIf",r.myError("lastName","maxlength")),t.xp6(5),t.Q6J("ngIf",r.myError("email","email")),t.xp6(7),t.Q6J("ngIf",r.myError("adminCode","maxlength")),t.xp6(4),t.Q6J("type",r.hide?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",r.hide),t.xp6(2),t.Oqu(r.hide?"visibility_off":"visibility"),t.xp6(3),t.Q6J("ngIf",r.myError("password","pattern")),t.xp6(4),t.Q6J("type",r.hide2?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",r.hide2),t.xp6(2),t.Oqu(r.hide2?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",r.myError("confirmPassword","match")),t.xp6(2),t.Q6J("disabled",!r.myForm.valid))},dependencies:[u.rH,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,w.O5,l.a8,l.dn,l.n5,m.KE,m.hX,m.bx,m.TO,m.R9,b.Nt,h.Hw,g.lW,g.RK],styles:[".register-form[_ngcontent-%COMP%]{max-width:500px}"]}),e})();const M=e=>{const a=e.get("password"),n=e.get("confirmPassword");return a?.value&&n?.value&&a.value!==n.value?(e.get("confirmPassword")?.setErrors({match:!0}),{confirmPassword:!0}):null},R=[{path:"login",pathMatch:"full",component:U,title:"Login"},{path:"register",pathMatch:"full",component:J,title:"Register"},{path:"logout",pathMatch:"full",component:(()=>{class e{constructor(n,r,i){this.router=n,this.tokenStorage=r,this._snackBar=i,this.isLoggedIn=!1,this.errorMessage=""}ngOnInit(){this.tokenStorage.getToken()||this.router.navigate(["/users/login"])}logOut(){this.tokenStorage.signOut(),p.A.showMessage(this._snackBar,"Log out successfully!"),setTimeout(()=>{this.router.navigate(["/"])},1e3)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.F0),t.Y36(v.i),t.Y36(y.ux))},e.\u0275cmp=t.Xpm({type:e,selectors:[["logout"]],decls:13,vars:0,consts:[[1,"logout-form","mx-auto","my-5"],[1,"py-3"],[1,"text-center","mt-3","mb-4","fs-2"],[1,"text-center"],["aria-hidden","false","aria-label","Example account_circle icon","fontIcon","account_circle",1,"h-100","w-100","text-secondary","mb-3",2,"font-size","50px"],[1,"text-center","mt-3"],["mat-raised-button","","color","primary","type","submit",3,"click"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"mat-card",1)(2,"mat-card-title",2),t._uU(3,"Logout"),t.qZA(),t.TgZ(4,"mat-card-content")(5,"div",3),t._UZ(6,"mat-icon",4)(7,"br"),t.TgZ(8,"mat-label"),t._uU(9,"You're logged in. Want to log out? "),t.qZA(),t.TgZ(10,"div",5)(11,"button",6),t.NdJ("click",function(){return r.logOut()}),t._uU(12,"Confirm"),t.qZA()()()()()())},dependencies:[l.a8,l.dn,l.n5,m.hX,h.Hw,g.lW],styles:[".logout-form[_ngcontent-%COMP%]{max-width:400px}"]}),e})(),title:"Logout"}];let S=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.Bz.forChild(R),u.Bz]}),e})();const F=[l.QW,m.lN,b.c,h.Ps,g.ot];let Y=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[S,o.UX,F]}),e})()}}]);